---
output:
  github_document:
    html_preview: true
---

<!-- Don't edit README.md; instead, edit README.Rmd -->

```{r setup, echo = FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  fig.show = "hold",
  fig.align = "center",
  out.width = "98%",
  fig.width = 7.5, 
  fig.asp = 0.9,
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

# fgeo.map: map ForestGEO's data <img src="https://i.imgur.com/39pvr4n.png" align="right" height=44 />

[![Build Status](https://travis-ci.org/forestgeo/fgeo.map.svg?branch=master)](https://travis-ci.org/forestgeo/fgeo.map)
[![Coverage status](https://codecov.io/gh/forestgeo/fgeo.map/branch/master/graph/badge.svg)](https://codecov.io/github/forestgeo/fgeo.map?branch=master)

## Installation

To install __fgeo.map__ run the following code in R:

```
missing_remotes <- !require(remotes)
if (missing_remotes) {
  install.packages("remotes")
}

remotes::install_github("forestgeo/fgeo.map")
```

To learn the details about how to install packages from GitHub, read [this blog post](https://goo.gl/dQKEeg).

## Example

```{r pkg}
library(fgeo.map)
library(bciex)
library(fgeo.tool)
library(dplyr)
```

Map species' distribution.

```{r fgeo.map-sp}
census <- bci12t7mini
# Fix structure of elevation data
elevation <- restructure_elev(bci_elevation)

# All maps
p <- maply_sp_elev(census, elevation, species = c("faraoc", "hybapr"))

# Show first map
first(p)
```

Map tree tags by status, showing four subquadrats per plot-page.

```{r map-tag}
# Fix two wrong names
viewfulltable <- rename(bci12vft_mini, qx = x, qy = y)

# Filter one plot and one census
vft <- filter(viewfulltable, PlotID == 1, CensusID == 6)

# All maps
p2 <- maply_tag(vft)
length(p2)

# Show first map
first(p2)
```

Map trees within a quadrat mapping tree diameter to point size.

```{r map-quad}
# Filtering:
# * Trees of diameter greater than 10 cm;
# * Last census;
# * Plot 1.
vft2 <- filter(
  viewfulltable,
  DBH > 10,
  CensusID == max(CensusID, na.rm = TRUE),
  PlotID == 1
)

# All maps
p3 <- maply_quad(vft2)
length(p3)

# Show first map
first(p3)
```

