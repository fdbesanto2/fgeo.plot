<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mapping species distribution • map</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">map</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions Index</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/index.html">Turorials</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Apps
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://bookdown.org/forestgeoguest/map_tag_app">Map tree tags for fieldwork</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">news</a>
</li>
<li>
  <a href="https://github.com/maurolepore">
    <span class="fa fa-gavel"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/forestgeo/map">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://forestgeo.github.io/fgeo/">fgeo</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Mapping species distribution</h1>
                        <h4 class="author">Mauro Lepore</h4>
            
            <h4 class="date">2017-12-08</h4>
          </div>

    
    
<div class="contents">
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p>This vignette shows you how to map species distribution with <code>map_sp()</code> and <code>map_sp_pdf()</code> from the <strong>forestr</strong> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># To install from a private repo, generate a personal access token (PAT) in</span>
<span class="co"># https://github.com/settings/tokens and supply to this argument.</span>
GITHUB_PAT &lt;-<span class="st"> "your token"</span>
<span class="co"># install_github("forestgeo/forestr", auth_token = GITHUB_PAT)</span>
<span class="kw">library</span>(forestr)

<span class="co"># Also using the package dplyr for easier data manipulation</span>
<span class="co"># install.packages(dplyr)</span>
<span class="kw">library</span>(dplyr)
<span class="co"># Print only a few rows of tibbles (modern dataframes) to save space</span>
<span class="kw">options</span>(<span class="dt">dplyr.print_min =</span> <span class="dv">6</span>, <span class="dt">dplyr.print_max =</span> <span class="dv">6</span>)</code></pre></div>
<p>Loading data for examples.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Converting dataframe to tibble for better printing</span>
example_data &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(forestr<span class="op">::</span>bci12t7mini)

<span class="co"># Let's find the top-3 most abundant species</span>
sp_n &lt;-<span class="st"> </span><span class="kw">count</span>(example_data, sp)
sp_arranged &lt;-<span class="st"> </span><span class="kw">arrange</span>(sp_n, <span class="kw">desc</span>(n))
sp_top3 &lt;-<span class="st"> </span>sp_arranged<span class="op">$</span>sp[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]
sp_top3
<span class="co">#&gt; [1] "hybapr" "faraoc" "des2pa"</span>

<span class="co"># For a small example, keeping data of only the 3 most abundant species</span>
census &lt;-<span class="st"> </span><span class="kw">filter</span>(example_data, sp  <span class="op">%in%</span><span class="st"> </span>sp_top3)
census
<span class="co">#&gt; # A tibble: 315 x 20</span>
<span class="co">#&gt;   treeID stemID    tag StemTag     sp quadrat    gx    gy MeasureID</span>
<span class="co">#&gt;    &lt;int&gt;  &lt;int&gt;  &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;int&gt;</span>
<span class="co">#&gt; 1   8651      1 010554         hybapr    4811   974 227.6      6832</span>
<span class="co">#&gt; 2   9480      1 011419         faraoc    4814   977 290.0      7373</span>
<span class="co">#&gt; 3  10179     11 012145    &lt;NA&gt; hybapr    4819   979 395.3      7898</span>
<span class="co">#&gt; 4  15240     NA 019314    &lt;NA&gt; hybapr    4223   845 461.2        NA</span>
<span class="co">#&gt; 5  15680     NA 019758    &lt;NA&gt; hybapr    4824   979 483.4        NA</span>
<span class="co">#&gt; 6  15888     NA 020180    &lt;NA&gt; faraoc    4701   950  29.8        NA</span>
<span class="co">#&gt; # ... with 309 more rows, and 11 more variables: CensusID &lt;int&gt;,</span>
<span class="co">#&gt; #   dbh &lt;dbl&gt;, pom &lt;chr&gt;, hom &lt;dbl&gt;, ExactDate &lt;chr&gt;, DFstatus &lt;chr&gt;,</span>
<span class="co">#&gt; #   codes &lt;chr&gt;, nostems &lt;dbl&gt;, date &lt;dbl&gt;, status &lt;chr&gt;, agb &lt;dbl&gt;</span></code></pre></div>
<p>The next section shows you how to explore data quickly. You will produce good quality maps with available defaults. The section after the next one shows you how to customize you maps by making some common and less common changes. And the last section shows you how to fine tune your maps.</p>
</div>
<div id="exploring-data-quickly-using-defaults" class="section level1">
<h1 class="hasAnchor">
<a href="#exploring-data-quickly-using-defaults" class="anchor"></a>Exploring Data Quickly: Using Defaults</h1>
<div id="mapping-species-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#mapping-species-distribution" class="anchor"></a>Mapping Species Distribution</h2>
<p>Although the output of <code>map_sp()</code> and <code>map_sp_pdf()</code> is printed to different devices – i.e, the screen or a .pdf file – those functions are almost identical. They are documented jointly and share the same arguments (except for the <code>file</code> argument that only belongs to <code>map_sp_pdf()</code>. (These functions are not merge into a single function because their outputs are different; functions that produce different output tend to cause more problems that those which output is consistently the same).</p>
<pre><code>?map_sp
# Or
?map_sp_pdf</code></pre>
<p>Notice that only the first two arguments of these functions are strictly necessary.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Print to screen</span>
<span class="kw">map_sp</span>(census, <span class="kw">c</span>(<span class="st">"hybapr"</span>, <span class="st">"faraoc"</span>))
<span class="co">#&gt; $hybapr</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $faraoc</span></code></pre></div>
<p><img src="map_sp_files/figure-html/unnamed-chunk-3-1.png" width="70%" style="display: block; margin: auto;"><img src="map_sp_files/figure-html/unnamed-chunk-3-2.png" width="70%" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Defaults to save in working directory. Returns invisibly.</span>
<span class="kw">map_sp_pdf</span>(census, <span class="kw">c</span>(<span class="st">"hybapr"</span>, <span class="st">"faraoc"</span>))
<span class="co">#&gt; Saving as map.pdf</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Force printing the invisible output</span>
<span class="kw">print</span>(<span class="kw">map_sp_pdf</span>(census, <span class="kw">c</span>(<span class="st">"hybapr"</span>, <span class="st">"faraoc"</span>)))
<span class="co">#&gt; Saving as map.pdf</span>
<span class="co">#&gt; $hybapr</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $faraoc</span>

<span class="co"># (Printing side by side to save space)</span></code></pre></div>
<p><img src="map_sp_files/figure-html/unnamed-chunk-5-1.png" width="45%"><img src="map_sp_files/figure-html/unnamed-chunk-5-2.png" width="45%"></p>
<p>Keep in mind that your census data must have specific variable-names:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Show behaviour with wrong name</span>
with_wrong_name &lt;-<span class="st"> </span><span class="kw">rename</span>(census, <span class="dt">SP =</span> sp)

<span class="co"># This will fail because the data set has name `SP`, not `sp`</span>
<span class="kw">map_sp</span>(with_wrong_name, <span class="kw">c</span>(<span class="st">"hybapr"</span>, <span class="st">"faraoc"</span>))
<span class="co">#&gt; Error: Check that your data contains these names: gx, gy, sp</span></code></pre></div>
</div>
<div id="adding-elevation" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-elevation" class="anchor"></a>Adding Elevation</h2>
<p>You may have elevation data from your site.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_elev &lt;-<span class="st"> </span>forestr<span class="op">::</span>bci_elevation
my_elev
<span class="co">#&gt; # A tibble: 20,301 x 3</span>
<span class="co">#&gt;       x     y  elev</span>
<span class="co">#&gt; * &lt;int&gt; &lt;int&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     0     0   121</span>
<span class="co">#&gt; 2     0     5   121</span>
<span class="co">#&gt; 3     0    10   121</span>
<span class="co">#&gt; 4     0    15   121</span>
<span class="co">#&gt; 5     0    20   121</span>
<span class="co">#&gt; 6     0    25   123</span>
<span class="co">#&gt; # ... with 2.03e+04 more rows</span></code></pre></div>
<p>Note that the elevation data set must have very specific variable names; or it will fail:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># This will fail because the names of `my_elev` are not correct</span>
<span class="kw">map_sp</span>(census, <span class="kw">c</span>(<span class="st">"hybapr"</span>, <span class="st">"faraoc"</span>), <span class="dt">elevation =</span> my_elev)
<span class="co">#&gt; Error: Check that your data contains these names: gx, gy, elev</span></code></pre></div>
<p>If necessary, rename your variables:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Renaming data and trying again</span>
elev &lt;-<span class="st"> </span><span class="kw">rename</span>(my_elev, <span class="dt">gx =</span> x, <span class="dt">gy =</span> y)
<span class="kw">map_sp</span>(census, <span class="kw">c</span>(<span class="st">"hybapr"</span>, <span class="st">"faraoc"</span>), <span class="dt">elevation =</span> elev)
<span class="co">#&gt; $hybapr</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $faraoc</span></code></pre></div>
<p><img src="map_sp_files/figure-html/unnamed-chunk-9-1.png" width="70%" style="display: block; margin: auto;"><img src="map_sp_files/figure-html/unnamed-chunk-9-2.png" width="70%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="dealing-with-overplotting" class="section level1">
<h1 class="hasAnchor">
<a href="#dealing-with-overplotting" class="anchor"></a>Dealing with Overplotting</h1>
<p>Sometimes a species is so abundant that its distribution overplots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fake over abundant species</span>
crowded &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/reexports.html">tibble</a></span>(
  <span class="dt">sp =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">"species1"</span>), <span class="dv">10000</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>),
  <span class="dt">gx =</span> <span class="kw">sample.int</span>(<span class="dv">1000</span>, <span class="dv">10000</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>),
  <span class="dt">gy =</span> <span class="kw">sample.int</span>(<span class="dv">500</span>, <span class="dv">10000</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
)
<span class="kw">map_sp</span>(crowded, <span class="kw">c</span>(<span class="st">"species1"</span>))
<span class="co">#&gt; $species1</span></code></pre></div>
<p><img src="map_sp_files/figure-html/unnamed-chunk-10-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>To reduce overplotting, you can do a number of things. First, you can try reducing the size or opacity of the points, or changing their shape.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># smaller and semi transparent</span>
<span class="kw">map_sp</span>(crowded, <span class="kw">c</span>(<span class="st">"species1"</span>), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">10</span>)
<span class="co">#&gt; $species1</span>

<span class="co"># Smaller and open</span>
<span class="kw">map_sp</span>(crowded, <span class="kw">c</span>(<span class="st">"species1"</span>), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">shape =</span> <span class="dv">21</span>)
<span class="co">#&gt; $species1</span>

<span class="co"># (Printing side by side to save space)</span></code></pre></div>
<p><img src="map_sp_files/figure-html/unnamed-chunk-11-1.png" width="45%"><img src="map_sp_files/figure-html/unnamed-chunk-11-2.png" width="45%"></p>
<p>If your research question allows, you can try subsampling your data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># A random sample of 2000 stems</span>
smaller &lt;-<span class="st"> </span><span class="kw">sample_n</span>(crowded, <span class="dv">2000</span>)
<span class="kw">map_sp</span>(smaller, <span class="kw">c</span>(<span class="st">"species1"</span>), <span class="dt">shape =</span> <span class="dv">21</span>)
<span class="co">#&gt; $species1</span></code></pre></div>
<p><img src="map_sp_files/figure-html/unnamed-chunk-12-1.png" width="70%" style="display: block; margin: auto;"></p>
</div>
<div id="customizing-your-maps" class="section level1">
<h1 class="hasAnchor">
<a href="#customizing-your-maps" class="anchor"></a>Customizing Your Maps</h1>
<p>You may want to customize your maps. For example, you may want to change some properties of the points or elevation lines (e.g. colour); or the general theme of the map. These are relatively common changes.</p>
<div id="most-common-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#most-common-changes" class="anchor"></a>Most Common Changes</h2>
<div id="changing-points-properties" class="section level3">
<h3 class="hasAnchor">
<a href="#changing-points-properties" class="anchor"></a>Changing Points’ Properties</h3>
<p>Both <code>map_sp()</code> and <code>map_sp_pdf()</code> have the argument <code>...</code>, which lets you pass arguments to <code><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_point">ggplot2::geom_point()</a></code> to change points’ properties such as the shape, size, fill, colour, and stroke. Read <code>?ggplot2::geom_point()</code> to learn all your options; here you can see some common ones:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map_sp</span>(census, <span class="st">"hybapr"</span>,
  <span class="co"># Arguments passed to ggplot2::geom_point()</span>
  <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">shape =</span> <span class="dv">22</span>, <span class="dt">fill =</span> <span class="st">"green"</span>, <span class="dt">colour =</span> <span class="st">"black"</span>, <span class="dt">stroke =</span> <span class="dv">2</span>)
<span class="co">#&gt; $hybapr</span></code></pre></div>
<p><img src="map_sp_files/figure-html/unnamed-chunk-13-1.png" width="70%" style="display: block; margin: auto;"></p>
</div>
<div id="changing-properties-of-the-elevation-lines" class="section level3">
<h3 class="hasAnchor">
<a href="#changing-properties-of-the-elevation-lines" class="anchor"></a>Changing Properties of the Elevation Lines</h3>
<p>You can also customize the elevation lines. This example shows all the available options:</p>
<ul>
<li>Change line size;</li>
<li>set colours to represent low and high elevation;</li>
<li>set the number of intervals in which the elevation variable is to be cut (note that the cut results in ugly numbers, with many decimals; also, with increasing bins’ number the function takes longer to run).</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map_sp</span>(census, <span class="st">"hybapr"</span>, 
  <span class="dt">elevation =</span> elev, <span class="dt">line_size =</span> <span class="dv">1</span>, <span class="dt">low =</span> <span class="st">"red"</span>, <span class="dt">high =</span> <span class="st">"blue"</span>, <span class="dt">bins =</span> <span class="dv">4</span>)
<span class="co">#&gt; $hybapr</span></code></pre></div>
<p><img src="map_sp_files/figure-html/unnamed-chunk-14-1.png" width="70%" style="display: block; margin: auto;"></p>
</div>
<div id="changing-the-theme" class="section level3">
<h3 class="hasAnchor">
<a href="#changing-the-theme" class="anchor"></a>Changing the Theme</h3>
<p>You can change the general look of your map by changing its theme. A number of pre-set themes are available in the <strong>ggplot2</strong> package (see <code>?ggplot2::theme_bw()</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map_sp</span>(census, <span class="st">"hybapr"</span>, <span class="dt">theme =</span> ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_classic</a></span>())
<span class="co">#&gt; $hybapr</span>
<span class="kw">map_sp</span>(census, <span class="st">"hybapr"</span>, <span class="dt">theme =</span> ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_dark</a></span>())
<span class="co">#&gt; $hybapr</span>

<span class="co"># (Printing side by side to save space)</span></code></pre></div>
<p><img src="map_sp_files/figure-html/unnamed-chunk-15-1.png" width="45%"><img src="map_sp_files/figure-html/unnamed-chunk-15-2.png" width="45%"></p>
</div>
</div>
<div id="less-common-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#less-common-changes" class="anchor"></a>Less Common Changes</h2>
<p>Here are some changes that you may need less often but are still good to keep in mind.</p>
<div id="change-file-name" class="section level3">
<h3 class="hasAnchor">
<a href="#change-file-name" class="anchor"></a>Change File Name</h3>
<p>When printing to .pdf, you can provide a custom file name (including the path to a directory); but note the file name must end in <em>.pdf</em> or it will be replaced by a default name:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">spp &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"hybapr"</span>, <span class="st">"faraoc"</span>)

<span class="kw">map_sp_pdf</span>(census, spp, <span class="dt">elevation =</span> elev, <span class="dt">file =</span> <span class="st">"bad-name1"</span>)
<span class="co">#&gt; Warning in check_file_extension(file): File extension should be .pdf.</span>
<span class="co">#&gt;   * Replacing given file name by default file name</span>
<span class="co">#&gt; Saving as map.pdf</span>

<span class="kw">map_sp_pdf</span>(census, spp, <span class="dt">elevation =</span> elev, <span class="dt">file =</span> <span class="st">"bad-name2.png"</span>)
<span class="co">#&gt; Warning in check_file_extension(file): File extension should be .pdf.</span>
<span class="co">#&gt;   * Replacing given file name by default file name</span>
<span class="co">#&gt; Saving as map.pdf</span></code></pre></div>
<p>This is OK. (Note that you can suppress messages)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map_sp_pdf</span>(census, spp, <span class="dt">elevation =</span> elev, <span class="dt">file =</span> <span class="st">"good-name.pdf"</span>)
<span class="co">#&gt; Saving as good-name.pdf</span>

<span class="co"># Same without any message</span>
<span class="kw">suppressMessages</span>(
  <span class="kw">map_sp_pdf</span>(census, spp, <span class="dt">elevation =</span> elev, <span class="dt">file =</span> <span class="st">"good-name.pdf"</span>)
)</code></pre></div>
</div>
<div id="change-x-and-y-limits" class="section level3">
<h3 class="hasAnchor">
<a href="#change-x-and-y-limits" class="anchor"></a>Change x and y Limits</h3>
<p>Occasionally you may need to change the map limits. The map limits default to the range 0-max, where max is the maximum value of the variable <code>gx</code> or <code>gy</code> in the census data. In the unlikely case where no stem occurs at the maximum limits of your plot, the default would result in a map that spans less than the defined limits of the site’s plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fake case: The maximum-limits of the site's plot are gx = 1000 and gy = 500;</span>
<span class="co"># but all stems in the census occurr at lower gx and gy limits</span>
odd_data &lt;-<span class="st"> </span><span class="kw">filter</span>(census, gx <span class="op">&lt;</span><span class="st"> </span><span class="dv">800</span>, gy <span class="op">&lt;</span><span class="st"> </span><span class="dv">200</span>)
two_species &lt;-<span class="st"> </span><span class="kw">unique</span>(odd_data<span class="op">$</span>sp)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]
<span class="kw">map_sp</span>(odd_data, two_species)
<span class="co">#&gt; $hybapr</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $faraoc</span>

<span class="co"># (Printing side by side to save space)</span></code></pre></div>
<p><img src="map_sp_files/figure-html/unnamed-chunk-18-1.png" width="45%"><img src="map_sp_files/figure-html/unnamed-chunk-18-2.png" width="45%"></p>
<p>You can overwrite the default limits with the arguments <code>xlim</code> and <code>ylim</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map_sp</span>(odd_data, two_species, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1000</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">500</span>))
<span class="co">#&gt; $hybapr</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $faraoc</span>

<span class="co"># (Printing side by side to save space)</span></code></pre></div>
<p><img src="map_sp_files/figure-html/unnamed-chunk-19-1.png" width="45%"><img src="map_sp_files/figure-html/unnamed-chunk-19-2.png" width="45%"></p>
</div>
</div>
</div>
<div id="fine-tunning" class="section level1">
<h1 class="hasAnchor">
<a href="#fine-tunning" class="anchor"></a>Fine Tunning</h1>
<p>This last section shows you how to fine tune your plots. For this, you will need a couple of functions from packages other than <strong>forestr</strong>.</p>
<div id="multiple-plots-in-one-page" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-plots-in-one-page" class="anchor"></a>Multiple Plots in One Page</h2>
<p>To plot multiple maps on one page you can use <code>gridExtra::maparrange()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gridExtra)

all_species &lt;-<span class="st"> </span><span class="kw">unique</span>(census<span class="op">$</span>sp)
maps &lt;-<span class="st"> </span><span class="kw">map_sp</span>(census, all_species)
multipaged &lt;-<span class="st"> </span><span class="kw">marrangeGrob</span>(maps, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)
multipaged</code></pre></div>
<p><img src="map_sp_files/figure-html/unnamed-chunk-20-1.png" width="70%" style="display: block; margin: auto;"><img src="map_sp_files/figure-html/unnamed-chunk-20-2.png" width="70%" style="display: block; margin: auto;"></p>
<p>The multi-paged maps can also be saved to a .pdf.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Saving to .pdf: Option 1</span>
ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggsave">ggsave</a></span>(<span class="st">"multi-paged.pdf"</span>, multipaged)
<span class="co">#&gt; Saving 6 x 3.7 in image</span>

<span class="co"># Saving to .pdf: Option 2</span>
<span class="kw">pdf</span>()
multipaged
<span class="kw">dev.off</span>()
<span class="co">#&gt; png </span>
<span class="co">#&gt;   2</span></code></pre></div>
<p>It is also possible to save the multi-paged maps to devices other than .pdf – the png() device, for example, will automatically create one file per page.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Saving to .png; this will create multiple files.</span>
<span class="kw">png</span>()
multipaged
<span class="kw">dev.off</span>()
<span class="co">#&gt; png </span>
<span class="co">#&gt;   2</span></code></pre></div>
</div>
<div id="customizing-the-theme" class="section level2">
<h2 class="hasAnchor">
<a href="#customizing-the-theme" class="anchor"></a>Customizing the Theme</h2>
<p>Before, you used a pre-made theme. But you can create your own theme with <code><a href="http://www.rdocumentation.org/packages/ggplot2/topics/theme">ggplot2::theme()</a></code>, save it as an object, and pass that object to <code>map_sp()</code> or <code>map_sp_pdf()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Showing only a few options; see all the options with ?ggplot2::theme()</span>
my_theme &lt;-<span class="st"> </span>ggplot2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(
  <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">25</span>, <span class="dt">face =</span> <span class="st">"bold.italic"</span>, <span class="dt">colour =</span> <span class="st">"white"</span>),
  <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"black"</span>),
  <span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="st">"cm"</span>),
  <span class="dt">strip.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"darkgreen"</span>),
  <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">colour =</span> <span class="st">"white"</span>),
  <span class="co"># make grid to dissapear by matching background colour</span>
  <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"lightgreen"</span>),
  <span class="dt">panel.grid.minor =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">"lightgreen"</span>),
  <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">"lightgreen"</span>)
)
<span class="kw">map_sp</span>(census, <span class="st">"hybapr"</span>, <span class="dt">theme =</span> my_theme)
<span class="co">#&gt; $hybapr</span></code></pre></div>
<p><img src="map_sp_files/figure-html/unnamed-chunk-23-1.png" width="70%" style="display: block; margin: auto;"></p>
</div>
<div id="extending-with-ggplot2" class="section level2">
<h2 class="hasAnchor">
<a href="#extending-with-ggplot2" class="anchor"></a>Extending with ggplot2</h2>
<p>Finally, you can also use the output of <code>map_sp()</code> and <code>map_pdf()</code> as the starting point for further customization with <strong>ggplot2</strong> (the next section provides resources to learn <strong>ggplot2</strong>). That may be convenient for minor extensions; for larger ones you may prefer to start from scratch. Note that <code>map_sp()</code> and <code>map_sp_pdf()</code> output not just one plot but a list of plots. That is important to keep in mind if you want to iterate over all the plot-elements of the output list. For example, this is how you would add a new layer to one element of the plots’ list:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p0 &lt;-<span class="st"> </span><span class="kw">map_sp</span>(census, <span class="kw">c</span>(<span class="st">"hybapr"</span>, <span class="st">"faraoc"</span>))

<span class="co"># Adding a new layer to one element of the plots' list</span>
p0[[<span class="st">"hybapr"</span>]] <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> <span class="dv">300</span>), <span class="dt">colour =</span> <span class="st">"red"</span>)</code></pre></div>
<p><img src="map_sp_files/figure-html/unnamed-chunk-24-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>And this is how you can apply new layers to all the plot-elements of a list (note that the function <code>+</code> is applied to each item of the plots’ list):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(p0, <span class="st">`</span><span class="dt">+</span><span class="st">`</span>, <span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> <span class="dv">300</span>), <span class="dt">colour =</span> <span class="st">"red"</span>))
p1
<span class="co">#&gt; $hybapr</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $faraoc</span>

p2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(p1, <span class="st">`</span><span class="dt">+</span><span class="st">`</span>, <span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="dv">400</span>), <span class="dt">colour =</span> <span class="st">"blue"</span>))
p2
<span class="co">#&gt; $hybapr</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $faraoc</span>

<span class="co"># (Printing side by side to save space)</span></code></pre></div>
<p><img src="map_sp_files/figure-html/unnamed-chunk-25-1.png" width="45%"><img src="map_sp_files/figure-html/unnamed-chunk-25-2.png" width="45%"><img src="map_sp_files/figure-html/unnamed-chunk-25-3.png" width="45%"><img src="map_sp_files/figure-html/unnamed-chunk-25-4.png" width="45%"></p>
</div>
<div id="learning-more" class="section level2">
<h2 class="hasAnchor">
<a href="#learning-more" class="anchor"></a>Learning More</h2>
<p>There are many visualization systems in R. The system built in <code>map_sp()</code> and <code>map_sp_pdf()</code> is that of the <strong>ggplot2</strong> package. <strong>ggplot2</strong> is not an arbitrary collection of functions; it is one implementation of <a href="https://goo.gl/E514ar">The Grammar of Graphics</a>. Good places to learn <strong>ggplot2</strong> include <a href="https://goo.gl/tVvLQZ">this website</a>; this specialized, paid book: <a href="https://goo.gl/R6wJk9">ggplot2: Elegant Graphics for Data Analysis</a>; and this general, free book <a href="http://r4ds.had.co.nz/">R for Data Science</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#overview">Overview</a></li>
      <li>
<a href="#exploring-data-quickly-using-defaults">Exploring Data Quickly: Using Defaults</a><ul class="nav nav-pills nav-stacked">
<li><a href="#mapping-species-distribution">Mapping Species Distribution</a></li>
      <li><a href="#adding-elevation">Adding Elevation</a></li>
      </ul>
</li>
      <li><a href="#dealing-with-overplotting">Dealing with Overplotting</a></li>
      <li>
<a href="#customizing-your-maps">Customizing Your Maps</a><ul class="nav nav-pills nav-stacked">
<li><a href="#most-common-changes">Most Common Changes</a></li>
      <li><a href="#less-common-changes">Less Common Changes</a></li>
      </ul>
</li>
      <li>
<a href="#fine-tunning">Fine Tunning</a><ul class="nav nav-pills nav-stacked">
<li><a href="#multiple-plots-in-one-page">Multiple Plots in One Page</a></li>
      <li><a href="#customizing-the-theme">Customizing the Theme</a></li>
      <li><a href="#extending-with-ggplot2">Extending with ggplot2</a></li>
      <li><a href="#learning-more">Learning More</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/maurolepore">Mauro Lepore</a>, <a href="http://www.forestgeo.si.edu/">CTFS-ForestGEO</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
